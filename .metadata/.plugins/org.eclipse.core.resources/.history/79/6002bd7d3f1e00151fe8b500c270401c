package conversion;

import main;

public class BoutonFermerConversionRule implements IConversionRule {

    @Override
    public void apply(DfmObject dfmObject) {
        if (dfmObject.getTypeName().compareToIgnoreCase("TSpeedButton") != 0)
            return;

        String caption = dfmObject.getProperties().get("Caption"); 
        if (caption == null)
            return;
        
        if (caption.compareToIgnoreCase("'Fermer'") != 0)
            return;
        
        final int BUTTON_HEIGHT = 55;
        final int BUTTON_WIDTH = 64;
        final int MARGIN = 7; 
        dfmObject.getProperties().put("Height", String.valueOf(BUTTON_HEIGHT));
        dfmObject.getProperties().put("Width", String.valueOf(BUTTON_WIDTH));
        dfmObject.getProperties().put("Transparent", "True");
        dfmObject.getProperties().put("Layout", "blGlyphTop");
        dfmObject.getProperties().put("Margin", "-1");
        dfmObject.getProperties().put("Spacing", "0");
        dfmObject.getProperties().put("ParentFont", "True");
        dfmObject.getProperties().put("Anchors", "[akRight, akBottom]");
        dfmObject.getProperties().put("Top", String.valueOf(Integer.parseInt(dfmObject.getParent().getProperties().get("ClientHeight")) - BUTTON_HEIGHT - MARGIN));
        dfmObject.getProperties().put("Left", String.valueOf(Integer.parseInt(dfmObject.getParent().getProperties().get("ClientWidth")) - BUTTON_WIDTH - MARGIN));
              

        String glyph = "{\r\n" +
            "36080000424D3608000000000000360400002800000020000000200000000100\r\n\r\n" +
            "08000000000000040000000000000000000000010000000100001C1F1D002528\r\n\r\n" +
            "2600292A2E002A2D2B002B2D2C00302C2E00302E2A002C2E2D002D2F2E002D30\r\n\r\n" +
            "2E0034322E003531330035332F003234330038353700343735003C383A00393B\r\n\r\n" +
            "3A003A3D3B003F3C3E00423E400043413C003F41400045423E00404241004143\r\n\r\n" +
            "4100454244004245430043444900444745004A4843004548460047494800484A\r\n" +
            "4900955D0000965D020053514D00985F0800515452009A610F00A36500009B62\r\n" +
            "110053545900545559009C631400A16900005558560098651400A26A02005C59\r\n" +
            "55009E6518005D595B009F661A00585B59009B681A00A1681E009D6A1E00615D\r\n" +
            "6000A66E1000A36A21005D605E00A76F1300A46B230063615C00A9701500A56C\r\n" +
            "2400A16E2400A66D2600A06B3100A26F260061646200AB721A00A3702700A674\r\n" +
            "190063656400A26D3400A4712900A7751B0069656700AD741E00A5722A00AB71\r\n" +
            "2C009F703400A8761D00A6732C00AC722E00A9771F00AF762200A7742D00A172\r\n" +
            "3700A3762C00A8752F00A2733800A4772E00A9763000AE7B2600AC783300A677\r\n" +
            "3D00AD793400A87B3300AE7A35006D706E006E716F00AB7E3700A67D4000AC7F\r\n" +
            "380072757300AD803A0079757700B0823C00B181480076797700B3854000B383\r\n" +
            "4A00B48641007E7A7C007E7C7700B5874200AF864B00B68843007B7E7C00B288\r\n" +
            "4D00B48A4F0080838100B58A5900B88E530088848600B2905100B98F55008985\r\n" +
            "8700848785008D908E00938F9100BD986500BF9A6700C09B6800C19C69009295\r\n" +
            "930099959700C0A073009E9A9C00A09C9E00A19D9F009EA19F00A4A0A3009FA0\r\n" +
            "A500CAAA7C00CBAB7D00CBA98500A2A3A800C5AB8200A3A6A400CDAD7F00AAA7\r\n" +
            "A200C7AD8400ABA7A900CAAD8D00CBB08700A8ABA900CFB48C00D2B69600AEB2\r\n" +
            "B000B8B6B100D2BB9F00BDBAB500CFBFA000B8BBB900D6BFA400D6C4AD00C4C0\r\n" +
            "C300D8C6AF00CAC7C200D6C8BC00C6C9C700CCC8CA00D9CBBF00CDC9CB00DACC\r\n" +
            "C000DACEBA00DBCFBB00CFCDC700DCD0BC00CACECB00DFD3BF00D4CFD200CED1\r\n" +
            "CF00D5D2CD00E9D7BF00D1D4D200E4D6CA00E5D7CB00E6D8CC00E7D9CD00DCDA\r\n" +
            "D500D7DBD900E5DECE00D9DCDA00E6DDD500E0DDD800EDE0CC00DCDFDD00EEE0\r\n" +
            "D400EAE2D900DFE2E000E5E1E300ECE4DB00E8E5E000EBE8E300E6E9E700EDEA\r\n" +
            "E500E8EBE900F5EDE400F8EFE700F2EDF000F2EFEA00F4F1EC00F6F3EE00F1F4\r\n" +
            "F200F7F3F500F7F5EF00F8F4F600F9F7F200FBF6F900FBF8F300F4F8F600FCF7\r\n" +
            "FA00FCF9F400FEFBF600F9FCFA00FFFBFD00FFFDF700FAFDFB00FFFEF800FFFF\r\n" +
            "F900FCFFFE000000000000000000000000000000000000000000000000000000\r\n" +
            "0000000000000000000000000000000000000000000000000000000000000000\r\n" +
            "0000000000000000000000000000000000000000000000000000EAEAEAEAEAEA\r\n" +
            "EAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEA\r\n" +
            "EAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEA\r\n" +
            "EAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEA\r\n" +
            "EAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEA\r\n" +
            "EAAFB3B5B1CAEAEAEAEAEAEAEAD6ACB5B5B2B7EAEAEAEAEAEAEAEAEAEAEAEAE5\r\n" +
            "7F585E5D583EC5EAEAEAEAEAEA9D3B5E5E5B4C93EAEAEAEAEAEAEAEAEAEAEA80\r\n" +
            "2D4C504D4C27BDEAEAEAEAEAEA9234504C505029A3EAEAEAEAEAEAEAEAEADE5E\r\n" +
            "505858585B2CBFEAEAEAEAEAEA9A375E5B585B486EEAEAEAEAEAEAEAEAEADC5E\r\n" +
            "585858585829BEEAEAEAEAEAEA94375B5B58584875EAEAEAEAEAEAEAEAEADD5F\r\n" +
            "58585058582CBEEAEAEAEAEAEA98385E5B5B584C76EAEAEAEAEAEAEAEAEADF62\r\n" +
            "4C585858582CBFEAEAEAEAEAEA982D5E5B5E5B4875EAEAEAEAEAEAEAEAEAE262\r\n" +
            "4C58585B5827C3EAEAEAEAEAEA9C375B5E5B5B4C72EAEAEAEAEAEAEAEAEADC62\r\n" +
            "505051505A28AAEAEAEAEAEAEA80405B585B5B4477EAEAEAEAEAEAEAEAEADE63\r\n" +
            "4758585858492DCDE2DFDFE3A832585E5E5B584B79EAEAEAEAEAEAEAEAEADD61\r\n" +
            "50585858585848366469675E344F5B58585B584C70EAEAEAEAEAEAEAEAEADF62\r\n" +
            "4758585858585B5845424050585B585B5B585B4577EAEAEAEAEAEAEAEAEADA58\r\n" +
            "4C58585858595858585B5B5B5B5B58585B585B436BEAEAEAEAEAEAEAEAEAEA7C\r\n" +
            "2F5B58505858585B58585B5E5B5B5E5A5858522796EAEAEAEAEA4E65D2EAEAEA\r\n" +
            "85254D5B5B5853585E5858585E5E5B50594323A7EAEAEAB9208E810417B4EAEA\r\n" +
            "EAA83E43505C5E58585B5B595B58574F3B68C9EAEAE38C0633B0EAA61D0C8AD8\r\n" +
            "EAEAC57A3A58585E5858585B585B454887E2EAEACE6C0E73E6EAEAEAC14A0B6A\r\n" +
            "CCEAEAD78B45475B5658585A583B589FE6EAEABA2E1A99E3EAEAEAEAEAD28405\r\n" +
            "2AADEAEAE4A5553E5E5858583871BBEAEAE09B1E16AEEAEAEAEAEAEAEAEAE6A9\r\n" +
            "0F158FE0EAEAC76B345B503287D3EAEACF7418133CEAEAEAEAEAEAEAEAEAEAEA\r\n" +
            "D01F036FDBEAEAD4862338A0E2EAEAB83F121C1439EAEAEAEAEAEAEAEAEAEAEA\r\n" +
            "EAE17E0846BCEAEAE7AAC0EAEAEA9E110D1B1B1635EAEAEAEAEAEAEAEAEAEAEA\r\n" +
            "EAEAEAA4160791EAEAEAEAEAE86601829724181278EAEAEAEAEAEAEAEAEAEAEA\r\n" +
            "EAEAEAEABA4E007BD1EAEAB631109BE8E8A2908DC6EAEAEAEAEAEAEAEAEAEAEA\r\n" +
            "EAEAEAEAEAD583022A95892126ABEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEA\r\n" +
            "EAEAEAEAEAEAEAA11F0A0978C8EAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEA\r\n" +
            "EAEAEAEAEAEAEAEACBC2C2D9EAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEA\r\n" +
            "EAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEA}";
        dfmObject.getProperties().put("Glyph.Data", glyph);
    }
}
